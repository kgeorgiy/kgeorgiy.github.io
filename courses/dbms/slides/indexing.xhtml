<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="ru" xml:lang="ru" xmlns="http://www.w3.org/1999/xhtml"><head><title>Базы данных / Хранение данных и индексирование</title><meta name="author" content="" /><link rel="stylesheet" type="text/css" media="screen, projection, print" href="scripts/slidy.css" /><link rel="stylesheet" type="text/css" href="scripts/prettify.css" /><link rel="stylesheet" type="text/css" href="scripts/kgeorgiy-slides.css" /><script type="text/javascript" src="scripts/slidy.js" charset="utf-8" /><script type="text/javascript" src="scripts/kgeorgiy-slides.js" charset="utf-8" /><script type="text/javascript" src="scripts/prettify.js" /><script type="text/javascript" src="scripts/lang-sql.js" /><script type="text/javascript" src="scripts/lang-javaModule.js" /><script type="text/javascript" src="scripts/lang-scala.js" /><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML" /><script type="text/javascript">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']], displayMath: [['$$','$$']], ignoreClass: "", processClass: "math|lang-math"}});</script><script>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-37693764-1"]);_gaq.push(["_setDomainName","kgeorgiy.info"]);_gaq.push(["_trackPageview"]);(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-8EQ66D87ZZ" /><script>
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());

                  gtag('config', 'G-8EQ66D87ZZ');
                </script></head><body onload="prettyPrint()"><div id="all">
<div class="slide cover"><div class="content"><div class="course">Базы данных</div><hr /><div class="lecture"><div>Хранение данных и индексирование</div></div><div class="link"><a href="https://kgeorgiy.info/courses/dbms/">https://kgeorgiy.info/courses/dbms/</a></div><div class="copyright"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.ru"><span class="copyright">Copyright © Георгий Корнеев</span><img src="scripts/by-nc-sa.png" alt="Attribution-NonCommercial-ShareAlike" /></a></div></div></div>
<div class="slide section"><div class="content"><h1>Подсистема хранения данных</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Подсистема хранения данных</a><ol class="level-2 toc-2"><li><a href="#(3)" class="">Структура</a></li><li><a href="#(9)" class="">Организация данных</a></li></ol></li><li><a href="#(16)" class="toc">Индексация данных</a></li><li><a href="#(54)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">2</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Структура</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Подсистема хранения данных</a><ol class="level-2 toc-2"><li><a href="#(3)" class=" current">Структура</a></li><li><a href="#(9)" class="">Организация данных</a></li></ol></li><li><a href="#(16)" class="toc">Индексация данных</a></li><li><a href="#(54)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">3</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Типы памяти </h1><div class="body"><table><tr><th> Тип </th><th> Характеристика </th><th> Величина</th></tr><tr><td rowspan="4"> Оперативная память </td><td class="small"> Объем </td><td class="small"> 16−256 ГБ</td></tr><tr><td class="small"> Цена </td><td class="small"> ~2-3 $/ГБ</td></tr><tr><td class="small"> Быстродействие </td><td class="small"> ~100+ ГБ/c</td></tr><tr><td class="small"> Время доступа </td><td class="small"> 1−10 μ/c</td></tr><tr><td rowspan="4"> SSD </td><td class="small"> Объем </td><td class="small"> 1−16 ТБ</td></tr><tr><td class="small"> Цена </td><td class="small"> ~0.1 $/ГБ</td></tr><tr><td class="small"> Быстродействие </td><td class="small"> 0.500−6 ГБ/c</td></tr><tr><td class="small"> Время доступа </td><td class="small"> 0.1−0.2 мс</td></tr><tr><td rowspan="4"> Жёсткие диски </td><td class="small"> Объем </td><td class="small"> 4−20 ТБ</td></tr><tr><td class="small"> Цена </td><td class="small"> 0.03 $/ГБ</td></tr><tr><td class="small"> Быстродействие </td><td class="small"> 10−200 МБ/c</td></tr><tr><td class="small"> Время доступа </td><td class="small"> 5−100 мc</td></tr></table></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">4</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Особенности жёстких дисков</h1><div class="body"><ul class="item-1 level-1"><li>Большое время поиска</li><li>Скорость чтения<ul class="item-2 level-2"><li>Последовательный доступ – средняя</li><li>Случайный доступ – низкая</li></ul></li><li class="incremental"><div class="non-incremental">Сократить число обращений<ul class="item-2 level-2"><li>Сделать их последовательными</li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">5</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Страницы памяти</h1><div class="body"><ul class="item-1 level-1"><li>Память разбита на равные страницы<ul class="item-2 level-2"><li>Прямое отображение в память</li><li>Загрузка и выгрузка всей страницы</li><li>Для IA32 и AMD64 обычно 4КБ, 2МБ или 4МБ</li></ul></li><li>Обработка быстрее чем чтение</li><li>Последовательности страниц<ul class="item-2 level-2"><li>Данные одного типа</li><li>Частые переходы к следующей/предыдущей странице</li><li>Желательно хранить последовательно</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">6</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Доступ к данным </h1><div class="body"><img class="bottom" src="pics/DataStorage_Scheme.png" /></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">7</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Модули системы хранения</h1><div class="body"><ul class="item-1 level-1"><li>Диспетчер диска<ul class="item-2 level-2"><li>Каталог страниц</li><li>Оптимизация последовательностей страниц</li></ul></li><li>Диспетчер страниц<ul class="item-2 level-2"><li>Доступ к страницам</li><li>Распределение памяти</li><li>Выгрузка данных</li></ul></li><li>Диспетчер записей<ul class="item-2 level-2"><li>Доступ к записям</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">8</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Организация данных</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Подсистема хранения данных</a><ol class="level-2 toc-2"><li><a href="#(3)" class="">Структура</a></li><li><a href="#(9)" class=" current">Организация данных</a></li></ol></li><li><a href="#(16)" class="toc">Индексация данных</a></li><li><a href="#(54)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">9</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Организация данных</h1><div class="body"><ul class="item-1 level-1"><li>Файл – одна или несколько таблиц</li><li>Таблица – несколько страниц</li><li>Страница – несколько записей</li><li><span class="question">Какие проблемы?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Записи длиннее страницы</div></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">10</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Список страниц</h1><div class="body"><ul class="item-1 level-1"><li>Диспетчер диска – последовательности</li><li>Диспетчер памяти – предвыборка <img class="bottom" src="pics/Layout_PageList.png" /></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">11</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Идентификатор записи</h1><div class="body"><ul class="item-1 level-1"><li><var>Id</var> записи (RID)<ul class="item-2 level-2"><li><var>Id</var> страницы</li><li><var>Id</var> записи на странице</li></ul></li><li>Используется во многих местах<ul class="item-2 level-2"><li>Не должен меняться</li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Как хранить данные страницы?</span></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">12</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Записи на странице </h1><div class="body"><img class="bottom" src="pics/Layout_RecordsOnPage.png" /><ul class="item-1 level-1"><li class="incremental"><div class="non-incremental"><span class="question">Что делать, когда записи не помещаются?</span></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">13</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Страницы переполнения </h1><div class="body"><img class="bottom" src="pics/Layout_OverflowPage.png" /><ul class="item-1 level-1"><li class="incremental"><div class="non-incremental"><span class="question">Как избежать цепочек?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Изменять ссылки на исходной странице</div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">14</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Сжатие данных</h1><div class="body"><ul class="item-1 level-1"><li>Данные на страницах можно сжимать<ul class="item-2 level-2"><li>Больше вычислений</li><li>Меньше ввода-вывода</li><li>Часто – быстрее</li></ul></li><li>Использование структуры данных<ul class="item-2 level-2"><li>Сжатие по полям</li><li>Инкрементальное сжатие</li><li>Префиксное сжатие</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">15</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Индексация данных</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Подсистема хранения данных</a></li><li><a href="#(16)" class="toc current">Индексация данных</a><ol class="level-2 toc-2"><li><a href="#(17)" class="">Индексы</a></li><li><a href="#(23)" class="">Хэш-индексы</a></li><li><a href="#(30)" class="">Упорядоченные индексы</a></li><li><a href="#(37)" class="">Другие типы индексов</a></li><li><a href="#(47)" class="">Применение индексов</a></li></ol></li><li><a href="#(54)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">16</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Индексы</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Подсистема хранения данных</a></li><li><a href="#(16)" class="toc current">Индексация данных</a><ol class="level-2 toc-2"><li><a href="#(17)" class=" current">Индексы</a></li><li><a href="#(23)" class="">Хэш-индексы</a></li><li><a href="#(30)" class="">Упорядоченные индексы</a></li><li><a href="#(37)" class="">Другие типы индексов</a></li><li><a href="#(47)" class="">Применение индексов</a></li></ol></li><li><a href="#(54)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">17</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Зачем нужна индексация?</h1><div class="body"><ul class="item-1 level-1"><li>Несколько миллионов+ записей</li><li>Как найти нужную?<ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Полный просмотр таблицы</div></li><li class="incremental"><div class="non-incremental">Индексация: поиск в структуре данных</div></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">18</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Полный просмотр таблицы</h1><div class="body"><ul class="item-1 level-1"><li>Последовательный перебор записей</li><li>Размер таблиц<ul class="item-2 level-2"><li>Большие и средние – медленно</li><li>Маленькие – быстро</li></ul></li><li>Количество выбираемых данных<ul class="item-2 level-2"><li>Малая доля – медленно</li><li>Бóльшая часть – быстро</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">19</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Индекс</h1><div class="body"><ul class="item-1 level-1"><li>Набор столбцов<ul class="item-2 level-2"><li>Не обязательно ключ</li></ul></li><li>Предварительная обработка<ul class="item-2 level-2"><li>При построении</li><li>При обновлении</li></ul></li><li>Быстрый поиск в индексе<ul class="item-2 level-2"><li>Указатель на запись</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">20</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Структура индекса </h1><div class="body"><div class="img-width"><img class="width" style="width: 60%" src="pics/Index_Structure.png" /></div><ul class="item-1 level-1"><li><span class="question">Почему не хранить данные в порядке индекса?</span></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">21</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Кластеризованный индекс </h1><div class="body"><div class="img-width"><img class="width" style="width: 40%" src="pics/Index_Clustered.png" /></div><ul class="item-1 level-1"><li>Выше скорость просмотра</li><li>Упорядоченность</li><li class="incremental"><div class="non-incremental"><span class="warn">Может быть только один</span></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">22</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Хэш-индексы</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Подсистема хранения данных</a></li><li><a href="#(16)" class="toc current">Индексация данных</a><ol class="level-2 toc-2"><li><a href="#(17)" class="">Индексы</a></li><li><a href="#(23)" class=" current">Хэш-индексы</a></li><li><a href="#(30)" class="">Упорядоченные индексы</a></li><li><a href="#(37)" class="">Другие типы индексов</a></li><li><a href="#(47)" class="">Применение индексов</a></li></ol></li><li><a href="#(54)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">23</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Хэш-индекс</h1><div class="body"><ul class="item-1 level-1"><li>Предварительная обработка<ul class="item-2 level-2"><li>Подсчёт хэшей ключей</li><li>Разбиение на корзины</li></ul></li><li>Поиск в индексе<ul class="item-2 level-2"><li>Просмотр корзины</li><li>Несколько ключей в корзине</li></ul></li><li>Заголовок помещается в памяти</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">24</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Простой хэш-индекс </h1><div class="body"><div class="img-width"><img class="width" style="width: 80%" src="pics/Index_Hash_Simple.png" /></div><ul class="item-1 level-1"><li><span class="question">Что делать, если корзина не помещается на страницу?</span></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">25</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Последовательности страниц </h1><div class="body"><div class="img-width"><img class="width" style="width: 80%" src="pics/Index_Hash_Sequence.png" /></div><ul class="item-1 level-1"><li>Линейное время поиска</li><li><span class="question">Что делать с большими корзинами?</span><ul class="item-2 level-2"><li>Перехэширование очень дорого</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">26</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Расширяемое хэширование</h1><div class="body"><ul class="item-1 level-1"><li>Большое количество корзин</li><li>Несколько корзин на одной странице<ul class="item-2 level-2"><li>Обычно – последовательных</li><li>Разделение корзин при переполнении страницы</li></ul></li><li>При плохой хэш-функции – не поможет </li></ul><div class="img-width"><img class="width" style="width: 70%" src="pics/Index_Hash_Extendable.png" /></div></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">27</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Побитное расш. хэширование</h1><div class="body"><ul class="item-1 level-1"><li>Глубина хэша <span class="mathO"><span class="math">$n$</span></span><ul class="item-2 level-2"><li><span class="mathO"><span class="math">$2^n$</span></span> корзин</li></ul></li><li>Локальная глубина страницы <span class="mathO"><span class="math">$k$</span></span><ul class="item-2 level-2"><li><span class="mathO"><span class="math">$2^{n-k}$</span></span> корзин на странице</li><li>Может быть разной</li></ul></li><li>Разделение корзин<ul class="item-2 level-2"><li>Страница глубины <span class="mathO"><span class="math">$k$</span></span> разделяется на две глубины <span class="mathO"><span class="math">$k + 1$</span></span></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">28</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Ускоряемые запросы</h1><div class="body"><ul class="item-1 level-1"><li>Проверка существования ключа<ul class="item-2 level-2"><li>Проверка повторений (ключи)</li><li><var>in</var></li><li><var>exist</var></li><li><var>count</var></li></ul></li><li>Поиск по ключу<ul class="item-2 level-2"><li>Естественные соединения</li><li><var>join using</var></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">29</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Упорядоченные индексы</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Подсистема хранения данных</a></li><li><a href="#(16)" class="toc current">Индексация данных</a><ol class="level-2 toc-2"><li><a href="#(17)" class="">Индексы</a></li><li><a href="#(23)" class="">Хэш-индексы</a></li><li><a href="#(30)" class=" current">Упорядоченные индексы</a></li><li><a href="#(37)" class="">Другие типы индексов</a></li><li><a href="#(47)" class="">Применение индексов</a></li></ol></li><li><a href="#(54)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">30</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Упорядоченные индексы</h1><div class="body"><ul class="item-1 level-1"><li>Предварительная обработка<ul class="item-2 level-2"><li>Ключи упорядочиваются по возрастанию</li></ul></li><li>Поиск в индексе<ul class="item-2 level-2"><li>Поиск в упорядоченной последовательности</li></ul></li><li class="incremental"><div class="non-incremental">Требуемые операции<ul class="item-2 level-2"><li>Вставка</li><li>Удаление</li><li>Быстрый поиск</li></ul></div></li><li class="incremental"><div class="non-incremental"><span class="question">Какую структуру данных использовать?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Деревья поиска</div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">31</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Деревья поиска</h1><div class="body"><ul class="item-1 level-1"><li>Количество операций<ul class="item-2 level-2"><li><span class="mathO"><span class="math">$O(высота)$</span></span></li><li>Минимизировать высоту</li></ul></li><li>Размер узла<ul class="item-2 level-2"><li>Размер страницы</li><li>⇒ Сильно ветвящиеся</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">32</span></div></div></div></div>
<div class="slide"><div class="content"><h1>B и B+ -деревья</h1><div class="body"><ul class="item-1 level-1"><li><span class="mathO"><span class="math">$B$</span></span> деревья степени <span class="mathO"><span class="math">$n$</span></span><ul class="item-2 level-2"><li>От <span class="mathO"><span class="math">$n/2$</span></span> до <span class="mathO"><span class="math">$n$</span></span> детей</li><li>Указатели и ключи хранятся в узлах</li></ul></li><li><span class="mathO"><span class="math">$B^+$</span></span> деревья степени <span class="mathO"><span class="math">$n$</span></span><ul class="item-2 level-2"><li>От <span class="mathO"><span class="math">$n/2$</span></span> до <span class="mathO"><span class="math">$n$</span></span> детей</li><li>Указатели хранятся в листьях</li></ul></li><li>Сравнение<ul class="item-2 level-2"><li>В <span class="mathO"><span class="math">$B^+$</span></span> меньше данных в узлах – сильнее ветвятся</li><li><span class="mathO"><span class="math">$B^+$</span></span> на одну страницу глубже</li></ul></li><li>Корень и несколько первых уровней – в памяти</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">33</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Плотные и разреженные</h1><div class="body"><ul class="item-1 level-1"><li>Плотный индекс<ul class="item-2 level-2"><li>Ключи всех записей</li></ul></li><li>Разреженный индекс<ul class="item-2 level-2"><li>Кластеризованный</li><li>Ключи части записей</li><li>Обычно – один на страницу</li></ul></li><li>Частичный индекс<ul class="item-2 level-2"><li>Ключи части записей</li><li>Выбираются по условию</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">34</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Данные и индексация</h1><div class="body"><ul class="item-1 level-1"><li>Строки<ul class="item-2 level-2"><li>Много данных в ключе – меньше степень ветвления</li><li>Можно использовать префиксы</li></ul></li><li class="incremental"><div class="non-incremental">Суррогатные ключи<ul class="item-2 level-2"><li>Малый размер</li><li>Неизменяемые</li><li>⇒ Высокая эффективность</li></ul></div></li><li class="incremental"><div class="non-incremental">Изменяющиеся данные<ul class="item-2 level-2"><li>Частое обновление индекса</li><li>Число чтений ≫ изменений</li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">35</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Ускоряемые запросы</h1><div class="body"><ul class="item-1 level-1"><li>Проверка существования ключа</li><li>Поиск по ключу</li><li>Минимум и максимум</li><li>Диапазон<ul class="item-2 level-2"><li>Загрузка</li><li><var>count</var></li></ul></li><li><var>like</var> по префиксу<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">name like 'M343%'
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">36</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Другие типы индексов</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Подсистема хранения данных</a></li><li><a href="#(16)" class="toc current">Индексация данных</a><ol class="level-2 toc-2"><li><a href="#(17)" class="">Индексы</a></li><li><a href="#(23)" class="">Хэш-индексы</a></li><li><a href="#(30)" class="">Упорядоченные индексы</a></li><li><a href="#(37)" class=" current">Другие типы индексов</a></li><li><a href="#(47)" class="">Применение индексов</a></li></ol></li><li><a href="#(54)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">37</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Пример битового индекса </h1><div class="body"><div class="img-width"><img class="width" style="width: 75%" src="pics/Index_Bitmap_1.png" /></div></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">38</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Битовый (bitmap) индекс</h1><div class="body"><ul class="item-1 level-1"><li>По одному биту на каждое возможное значение<ul class="item-2 level-2"><li>Хранятся битовые маски</li><li>По столбцам</li></ul></li><li>Ускоряемые запросы<ul class="item-2 level-2"><li>Логические выражения</li><li><var>count</var></li></ul></li><li>Долгое обновление</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">39</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Многозначный битовый индекс </h1><div class="body"><div class="img-width"><img class="width" style="width: 75%" src="pics/Index_Bitmap_2.png" /></div></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">40</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Битовый индекс с накоплением </h1><div class="body"><div class="img-width"><img class="width" style="width: 75%" src="pics/Index_Bitmap_3.png" /></div></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">41</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Составной битовый индекс </h1><div class="body"><div class="img-width"><img class="width" style="width: 85%" src="pics/Index_Bitmap_4.png" /></div></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">42</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Запрос по битовому индексу</h1><div class="body"><ul class="item-1 level-1"><li><var>Gender = 'М' and Year &gt;= 3</var></li><li><var>М and 3</var></li></ul><div class="img-width"><img class="width" style="width: 85%" src="pics/Index_Bitmap_5.png" /></div></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">43</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Оптимизация битового индекса</h1><div class="body"><ul class="item-1 level-1"><li>Часто целиком помещаются в памяти</li><li>Сжатие индекса<ul class="item-2 level-2"><li>RLE-кодирование</li><li>Byte-aligned Bitmap Code – логические операции без распаковки</li><li>Сложность перестроения</li></ul></li><li>Создание корзин<ul class="item-2 level-2"><li>Склеивание некоторых значений</li></ul></li><li><span class="question">Оцените размер сжатого битового индекса</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Число записей × число полей</div></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">44</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Пример R-дерева </h1><div class="body"><div class="img-width"><img class="width" style="width: 85%" src="pics/Index_Other_RTree.png" /></div><ul class="item-1 level-1"><li>Составные индексы</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">45</span></div></div></div></div>
<div class="slide"><div class="content"><h1>R-деревья</h1><div class="body"><ul class="item-1 level-1"><li>Разбиение данных на параллелепипеды<ul class="item-2 level-2"><li>Минимальные охватывающие</li></ul></li><li>Ускоряемые запросы<ul class="item-2 level-2"><li>Диапазоны по нескольким координатам</li><li>Поиск ближайших значений</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">46</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Применение индексов</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Подсистема хранения данных</a></li><li><a href="#(16)" class="toc current">Индексация данных</a><ol class="level-2 toc-2"><li><a href="#(17)" class="">Индексы</a></li><li><a href="#(23)" class="">Хэш-индексы</a></li><li><a href="#(30)" class="">Упорядоченные индексы</a></li><li><a href="#(37)" class="">Другие типы индексов</a></li><li><a href="#(47)" class=" current">Применение индексов</a></li></ol></li><li><a href="#(54)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">47</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Выбор типа индекса</h1><div class="body"><ul class="item-1 level-1"><li>Поиск по <var>(Фамилия, Имя)</var></li><li class="incremental"><div class="non-incremental">Хэш индекс<ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><span class="question">Компактный</span></div></li><li class="incremental"><div class="non-incremental"><span class="warn">Поиск только по фамилии</span></div></li></ul></div></li><li class="incremental"><div class="non-incremental">Упорядоченный индекс<ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><span class="question">Поиск по фамилии</span></div></li><li class="incremental"><div class="non-incremental"><span class="question">Поиск по префиксу</span></div></li><li class="incremental"><div class="non-incremental"><span class="question">Возможность использования диапазонов</span></div></li><li class="incremental"><div class="non-incremental"><span class="warn">Индекс на строках</span></div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">48</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Селективность индекса</h1><div class="body"><ul class="item-1 level-1"><li>Насколько хорошо индекс «раскидывает» данные<ul class="item-2 level-2"><li>Процент записей, получаемых по значению</li><li><var>count distinct / count</var> – среднее</li><li><var>max count / count</var> – худшее</li></ul></li><li>Примеры<ul class="item-2 level-2"><li>Номер паспорта – высокая селективность</li><li>Возраст человека – средняя селективность</li><li>Пол человека – низкая селективность</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">49</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Оценка селективности</h1><div class="body"><ul class="item-1 level-1"><li>Статистика<ul class="item-2 level-2"><li>Предыдущие запросы</li><li>Специальный подсчёт</li></ul></li><li>Хэш-индексы<ul class="item-2 level-2"><li>Размеры и количество корзин</li></ul></li><li><span class="mathO"><span class="math">$B$</span></span>-деревья<ul class="item-2 level-2"><li>Верхние уровни – гистограмма распределения</li></ul></li><li>При низкой селективности индекс не используется</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">50</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Покрывающий индекс</h1><div class="body"><ul class="item-1 level-1"><li>В индексе есть все требуемые столбцы<ul class="item-2 level-2"><li>Не требуется загрузка записи</li></ul></li><li>Дополнительные столбцы индекса<ul class="item-2 level-2"><li>По которым индексация не требуется</li><li>Увеличение размера индекса</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">51</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Рекомендации</h1><div class="body"><ul class="item-1 level-1"><li>Индексы на ключи</li><li>Индексы на внешние ключи</li><li>Индексы на запросы по диапазонам</li><li>Индексы таблиц связей<ul class="item-2 level-2"><li>Упорядоченные индексы на <var>(<span class="mathO"><span class="math">$id_1$</span></span>, <span class="mathO"><span class="math">$id_2$</span></span>)</var> и <var>(<span class="mathO"><span class="math">$id_2$</span></span>, <span class="mathO"><span class="math">$id_1$</span></span>)</var></li></ul></li><li>Индексы на строки<ul class="item-2 level-2"><li>Только для массовых операций над строками</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">52</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Индексы и SQL</h1><div class="body"><ul class="item-1 level-1"><li>При определении таблицы<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">index {имя} {unique|sparse|..} 
[using метод] (столбцы)
</pre></li></ul></li><li class="incremental"><div class="non-incremental">После определения таблицы<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">create {unique|sparse|..} index {имя} on таблица 
[using метод] (столбцы)
</pre></li></ul></div></li><li class="incremental"><div class="non-incremental">Частичные индексы<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">where условие
</pre></li></ul></div></li><li class="incremental"><div class="non-incremental">Удаление индекса<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">drop index {name}
</pre></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">53</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Литература</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Подсистема хранения данных</a></li><li><a href="#(16)" class="toc">Индексация данных</a></li><li><a href="#(54)" class="toc current">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">54</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Основная литература</h1><div class="body"><ul class="item-1 level-1"><li><em>Дейт К.</em> Введение в системы баз данных (Приложение Г)</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">55</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Дополнительная литература</h1><div class="body"><ul class="item-1 level-1"><li><em>Кнут Д.</em> Искусство программирования. Том 3. Сортировка и поиск</li><li><em>Silberschatz A.</em>, <em>Korth H. F.</em>, <em>Sudarshan S.</em> Database System Concepts</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Хранение данных и индексирование</span><span class="number">56</span></div></div></div></div></div></body></html>