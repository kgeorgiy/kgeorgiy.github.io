<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="ru" xml:lang="ru" xmlns="http://www.w3.org/1999/xhtml"><head><title>Базы данных / Реляционное исчисление</title><meta name="author" content="" /><link rel="stylesheet" type="text/css" media="screen, projection, print" href="scripts/slidy.css" /><link rel="stylesheet" type="text/css" href="scripts/prettify.css" /><link rel="stylesheet" type="text/css" href="scripts/kgeorgiy-slides.css" /><script type="text/javascript" src="scripts/slidy.js" charset="utf-8" /><script type="text/javascript" src="scripts/kgeorgiy-slides.js" charset="utf-8" /><script type="text/javascript" src="scripts/prettify.js" /><script type="text/javascript" src="scripts/lang-sql.js" /><script type="text/javascript" src="scripts/lang-javaModule.js" /><script type="text/javascript" src="scripts/lang-scala.js" /><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML" /><script type="text/javascript">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']], displayMath: [['$$','$$']], ignoreClass: "", processClass: "math|lang-math"}});</script><script>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-37693764-1"]);_gaq.push(["_setDomainName","kgeorgiy.info"]);_gaq.push(["_trackPageview"]);(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-8EQ66D87ZZ" /><script>
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());

                  gtag('config', 'G-8EQ66D87ZZ');
                </script></head><body onload="prettyPrint()"><div id="all"><span class="mathO"><span class="math">$ \newcommand\joineq{\raise{-0.05ex}{\unicode{xa78a}}} \newcommand{\rjoin}{\mathbin{⋉\mkern-6mu\joineq}} \newcommand{\ljoin}{\mathbin{\joineq\mkern-6mu⋊}} \newcommand{\ojoin}{\mathbin{\joineq\mkern-10mu×\mkern-10mu\joineq}}$</span></span>
<div class="slide cover"><div class="content"><div class="course">Базы данных</div><hr /><div class="lecture"><div>Реляционное исчисление</div></div><div class="link"><a href="https://kgeorgiy.info/courses/dbms/">https://kgeorgiy.info/courses/dbms/</a></div><div class="copyright"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.ru"><span class="copyright">Copyright © Георгий Корнеев</span><img src="scripts/by-nc-sa.png" alt="Attribution-NonCommercial-ShareAlike" /></a></div></div></div>
<div class="slide section"><div class="content"><h1>Реляционное исчисление</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Реляционное исчисление</a></li><li><a href="#(6)" class="toc">Исчисление кортежей</a></li><li><a href="#(14)" class="toc">Связь алгебры и исчисления</a></li><li><a href="#(21)" class="toc">Исчисление доменов</a></li><li><a href="#(27)" class="toc">Язык Datalog</a></li><li><a href="#(38)" class="toc">Реляционное исчисление и SQL</a></li><li><a href="#(49)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">2</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Реляционное исчисление</h1><div class="body"><ul class="item-1 level-1"><li>Декларативный язык для работы с отношениями<ul class="item-2 level-2"><li>Каким должен быть результат</li></ul></li><li>Виды реляционного исчисления<ul class="item-2 level-2"><li>Исчисление кортежей</li><li>Исчисление доменов</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">3</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Структура запроса</h1><div class="body"><ul class="item-1 level-1"><li>Части запроса<ul class="item-2 level-2"><li>Определение переменных</li><li>Определение атрибутов результата</li></ul></li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Определения переменных
select СписокАтрибутов
from Переменные
where Условие
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">4</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Алгебра vs. исчисление</h1><div class="body"><ul class="item-1 level-1"><li>Получить идентификаторы студентов, обучающихся в группе <var>M34371</var></li><li>Реляционная алгебра<ul class="item-2 level-2"><li><span class="mathO"><span class="math">$π_{SId}(σ_{Name=M34371}(Students ⋈ Groups))$</span></span></li></ul></li><li>Исчисление кортежей<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">select S.SId from S
where ∃G (S.GId = G.GId ∧ G.Name = 'M34371')
</pre></li></ul></li><li>Исчисление доменов<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">select SId from S
where ∃GId (S{SId=SId, GId=GId} ∧
    G{GId=GId, Name = 'M34371'})
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">5</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Исчисление кортежей</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Реляционное исчисление</a></li><li><a href="#(6)" class="toc current">Исчисление кортежей</a></li><li><a href="#(14)" class="toc">Связь алгебры и исчисления</a></li><li><a href="#(21)" class="toc">Исчисление доменов</a></li><li><a href="#(27)" class="toc">Язык Datalog</a></li><li><a href="#(38)" class="toc">Реляционное исчисление и SQL</a></li><li><a href="#(49)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">6</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Переменные-кортежи</h1><div class="body"><ul class="item-1 level-1"><li>Тип (кортежа)<ul class="item-2 level-2"><li>Имена и типы атрибутов</li><li>Набор значений</li></ul></li><li class="incremental"><div class="non-incremental">Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Переменная :: Отношение
</pre></li></ul></div></li><li class="incremental"><div class="non-incremental">Примеры<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">S :: Students
G :: Groups
G4 :: Groups where
    Name = 'M34351' ∨
    Name = 'M34371' ∨
    Name = 'M34391'
</pre></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">7</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Операции с отношениями</h1><div class="body"><ul class="item-1 level-1"><li>Ограничение<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Отношения where Условие
</pre></li></ul></li><li>Объединение (запятая)<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Отношение1, Отношение2
</pre></li></ul></li><li>Примеры<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Groups where Name = 'M34371'
</pre></li><li><pre class="prettyprint lang-sql">G4 :: Groups where Name = 'M34351',
         Groups where Name = 'M34371',
         Groups where Name = 'M34391'
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">8</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Условия</h1><div class="body"><ul class="item-1 level-1"><li>Простые условия</li><li>Составные условия</li><li>Условия с кванторами</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">9</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Простые условия</h1><div class="body"><ul class="item-1 level-1"><li>Сравнение атрибутов с константами<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">S.Name = 'Иван'
</pre></li><li><pre class="prettyprint lang-sql">S.Id &lt; 5
</pre></li></ul></li><li>Сравнение атрибутов между собой<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">S.Id ≥ G.Id
</pre></li></ul></li><li>Сравнение с применением формул<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">length(S.FirstName) = length(S.LastName) + 3
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">10</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Составные условия</h1><div class="body"><ul class="item-1 level-1"><li>Логические связки<ul class="item-2 level-2"><li><var>∨</var>, <var>∧</var>, <var>¬</var></li></ul></li><li>Примеры<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">G where Name = 'M34371' ∨ Name = 'M34391'
</pre></li><li><pre class="prettyprint lang-sql">S where FirstName = 'Иван' ∧ LastName &lt;&gt; 'Иванов'
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">11</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Условия с кванторами</h1><div class="body"><ul class="item-1 level-1"><li>Кванторы<ul class="item-2 level-2"><li>Всеобщности <var>∀</var></li><li>Существования <var>∃</var></li></ul></li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Квантор Переменная (Условие)
</pre></li></ul></li><li>Примеры<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">G where ∃S (S.FirstName = 'Иван' ∧ S.GId = G.GId)
</pre></li><li><pre class="prettyprint lang-sql">G where ∀S (S.FirstName = 'Иван' ∨ S.GId &lt;&gt; G.GId)
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">12</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Примеры</h1><div class="body"><ul class="item-1 level-1"><li>Переменные<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">S :: Students; G :: Groups; C :: Courses; P :: Point;
G4 :: Groups where Name = 'M34351' ∨
    Name = 'M34371' ∨ Name = 'M34391'
</pre></li></ul></li><li>Полностью аттестованные группы<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">select G.GId from G 
where ∀S (S.GId = G.GId → ∀C (∃P (
    S.SId = P.SId ∧ C.CId = P.CId ∧ P.Points ≥ 60)))
</pre></li></ul></li><li>Несколько отношений<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">select S.FirstName, S.LastName, G.Name
from S, G
where S.GId = G.GId
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">13</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Связь алгебры и исчисления</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Реляционное исчисление</a></li><li><a href="#(6)" class="toc">Исчисление кортежей</a></li><li><a href="#(14)" class="toc current">Связь алгебры и исчисления</a></li><li><a href="#(21)" class="toc">Исчисление доменов</a></li><li><a href="#(27)" class="toc">Язык Datalog</a></li><li><a href="#(38)" class="toc">Реляционное исчисление и SQL</a></li><li><a href="#(49)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">14</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Алгебра через исчисление (1)</h1><div class="body"><ul class="item-1 level-1"><li><span class="question">Как сделать <span class="mathO"><span class="math">$π_{A_1, ..., A_n}(R)$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">select A1, ..., An from R
</pre></div></li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$σ_θ(R)$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">from R where θ
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$ε_{A=expr}(R)$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">select R.*, expr as A from R
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 ∪ R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">R :: R1, R2
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 ∖ R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">R :: R1 where ¬∃R2 (R1 = R2)
</pre></div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">15</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Алгебра через исчисление (2)</h1><div class="body"><ul class="item-1 level-1"><li><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 × R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">R1.*, R2.* from R1, R2
</pre></div></li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 ⋈ R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">R1.*, R2.* from R1, R2 where 
                 R1.Атрибуты = R2.Атрибуты
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental">⇒ Выразительна мощность <br ignore="ignore" /> алгебры ≤ исчисления</div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">16</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Исчисление через алгебру</h1><div class="body"><ul class="item-1 level-1"><li>Предварённая нормальная форма<ul class="item-2 level-2"><li>Все кванторы</li><li>Условие</li></ul></li><li>Преобразование<ul class="item-2 level-2"><li>Построить выражения для каждой переменной</li><li>Взять декартово произведение</li><li>Отфильтровать по условию</li><li>Применить кванторы</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">17</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Применение кванторов</h1><div class="body"><ul class="item-1 level-1"><li>Квантор существования<ul class="item-2 level-2"><li>Проецируем, исключая атрибуты, порожденные переменной</li></ul></li><li>Квантор всеобщности<ul class="item-2 level-2"><li>Делим на все столбцы, порожденные переменной</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">18</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Пример преобразования</h1><div class="body"><ul class="item-1 level-1"><li><pre class="prettyprint lang-sql">select G.GId where ∃S (∀C (∃P
    (G.GId = S.GId ∧ S.SId = P.SId ∧
      C.CId = P.CId ∧ P.Points ≥ 60)))
</pre><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Группы, в которых есть хотя бы один студент, аттестованный по всем дисциплинам</div></li></ul></li><li class="incremental"><div class="non-incremental">Преобразование<ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><span class="mathO"><span class="math">$T_0 = σ_{P.Points ≥ 60}((G ⋈ S × C) ⋈ P)$</span></span></div></li><li class="incremental"><div class="non-incremental"><span class="mathO"><span class="math">$T_1 = π_{G_*, S_*, C_*}(T_0)$</span></span></div></li><li class="incremental"><div class="non-incremental"><span class="mathO"><span class="math">$T_2 = T_1 ÷ C$</span></span></div></li><li class="incremental"><div class="non-incremental"><span class="mathO"><span class="math">$T_3 = π_{G_*}(T_2)$</span></span></div></li><li class="incremental"><div class="non-incremental"><span class="mathO"><span class="math">$T = π_{G_*}(π_{G_*, S_*, C_*}(σ_{P.Points ≥ 60}((G ⋈ S × C) ⋈ P)) ÷ C)$</span></span></div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">19</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Реляционная полнота</h1><div class="body"><ul class="item-1 level-1"><li>Выразительная мощность исчисления = алгебры<ul class="item-2 level-2"><li>Алгебра рассматривается без расширения и агрегации</li></ul></li><li>Реляционно-полные языки<ul class="item-2 level-2"><li>Языки, выразительная мощность которых ≥ выразительной мощности реляционной алгебры</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">20</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Исчисление доменов</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Реляционное исчисление</a></li><li><a href="#(6)" class="toc">Исчисление кортежей</a></li><li><a href="#(14)" class="toc">Связь алгебры и исчисления</a></li><li><a href="#(21)" class="toc current">Исчисление доменов</a></li><li><a href="#(27)" class="toc">Язык Datalog</a></li><li><a href="#(38)" class="toc">Реляционное исчисление и SQL</a></li><li><a href="#(49)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">21</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Переменные-значения</h1><div class="body"><ul class="item-1 level-1"><li>Тип (значения)<ul class="item-2 level-2"><li>Имена и типы атрибутов</li><li>Набор значений</li></ul></li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Переменная :: Тип
</pre></li></ul></li><li>Примеры<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">SId :: Int
</pre></li><li><pre class="prettyprint lang-sql">FirstName :: Varchar(100)
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">22</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Условие принадлежности</h1><div class="body"><ul class="item-1 level-1"><li>Есть ли в отношении заданный кортеж<ul class="item-2 level-2"><li>Предикат</li></ul></li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Отношение {
    Атрибут1 = Значение1,
    Атрибут2 = Значение2,
    ...
}
</pre></li></ul></li><li>Примеры<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">S{FirstName = 'Иван', LastName = 'Иванов'}
</pre></li><li><pre class="prettyprint lang-sql">S{SId = Id}
</pre></li><li><pre class="prettyprint lang-sql">S{SId = SId}
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">23</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Примеры</h1><div class="body"><ul class="item-1 level-1"><li>Идентификаторы всех студентов<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">SId where S{SId = SId}
</pre></li></ul></li><li class="incremental"><div class="non-incremental">Идентификаторы студентов группы M34371<ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">SId where S{SId = SId, GId = 'M34371'}
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental">Идентификаторы студ. гр. M34371 и M34391<ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">SId where S{SId = SId, GId = 'M34371'} ∨
                 S{SId = SId, GId = 'M34391'}
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental">Идентификаторы студентов, не сдавших курс номер 10<ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">SId where ¬∃Points (Points ≥ 60 ∧
    P {SId = SId, Points = Points, CId = 10})
</pre></div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">24</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Алгебра через исчисление (1)</h1><div class="body"><ul class="item-1 level-1"><li><span class="question">Как сделать <span class="mathO"><span class="math">$π_{A_1, ..., A_n}(R)$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">A1, ..., An from R where R{A1=A1, ..., An = An}
</pre></div></li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$σ_θ(R)$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">A1, ..., An from R where R{A1=A1, ..., An = An} ∧ θ
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$ε_{A=expr}(R_1)$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">expr as A from R where R{A1=A1, ..., An = An}
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 ∪ R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">A1, ..., An where R1{Ai=Ai} ∨ R2{Ai=Ai}
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 ∖ R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">A1, ..., An where R1{Ai=Ai} ∧ ¬R2{Ai=Ai}
</pre></div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">25</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Алгебра через исчисление (2)</h1><div class="body"><ul class="item-1 level-1"><li><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 × R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">A1, ..., An, B1, ..., Bm where R1{Ai=Ai} ∧ R2{Bj=Bj}
</pre></div></li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 ⋈ R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">A1, ..., An, B1, ..., Bm, C1, ..., Cl where
    R1{Ai=Ai, Bj=Bj} ∧ R2{Ck=Ck, Bj=Bj}
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental">⇒ Исчисление доменов реляционно полно</div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">26</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Язык Datalog</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Реляционное исчисление</a></li><li><a href="#(6)" class="toc">Исчисление кортежей</a></li><li><a href="#(14)" class="toc">Связь алгебры и исчисления</a></li><li><a href="#(21)" class="toc">Исчисление доменов</a></li><li><a href="#(27)" class="toc current">Язык Datalog</a></li><li><a href="#(38)" class="toc">Реляционное исчисление и SQL</a></li><li><a href="#(49)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">27</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Datalog</h1><div class="body"><ul class="item-1 level-1"><li>Разработан в 1978<ul class="item-2 level-2"><li>Под влиянием Пролога</li><li>Повлиял на SQL</li><li>Исчисление доменов</li></ul></li><li>Программа<ul class="item-2 level-2"><li>Набор определений отношений</li><li>Результат – тело одного из отношений</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">28</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Атомы</h1><div class="body"><ul class="item-1 level-1"><li>Реляционные атомы<ul class="item-2 level-2"><li>Отношения рассматриваются как предикаты</li><li>Кортеж принадлежит отношению <pre class="prettyprint lang-sql">R(x1, x2, ..., xn)
</pre></li><li>Кортеж не принадлежит отношению <pre class="prettyprint lang-sql">¬R(x1, x2, ..., xn)
</pre></li><li>Вместо имен – порядок аргументов</li></ul></li><li>Арифметические атомы<ul class="item-2 level-2"><li>Сравнение двух выражений</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">29</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Определение отношения</h1><div class="body"><ul class="item-1 level-1"><li>Синтаксис<ul class="item-2 level-2"><li>Список <pre class="prettyprint lang-sql">Отношение(x1, x2, ..., xn) :- цель .
</pre></li><li>Каждая цель – последовательность атомов</li></ul></li><li>В отношение входят кортежи, удовлетворяющие хотя бы одной цели</li><li>Кортеж удовлетворяет цели – удовлетворяет всем атомам цели</li><li>⇒ запросы пишутся в ДНФ</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">30</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Примеры</h1><div class="body"><ul class="item-1 level-1"><li>Идентификаторы и фамилии всех Иванов<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Ivans(Id, LastName) :-
    Students(Id, FirstName, LastName),
    FirstName = 'Иван'.
</pre></li><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Ivans(Id, LastName) :-
    Students(Id, 'Иван', LastName).
</pre></div></li></ul></li><li class="incremental"><div class="non-incremental">Имена всех студентов и преподавателей<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Names(Name) :- Students(_, Name, _).
Names(Name) :- Lecturers(_, Name, _).
</pre></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">31</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Ограничение отношений</h1><div class="body"><ul class="item-1 level-1"><li>Бесконечные отношения<ul class="item-2 level-2"><li>Бесконечно много элементов неизвестного типа <pre class="prettyprint lang-sql">Less(x, y) :- x &lt; y.
</pre></li><li>Бесконечно много элементов (не)известного типа <pre class="prettyprint lang-sql">NotStudent(Id, Name) :- ¬Students(Id, Name, _).
</pre></li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Как запретить бесконечные отношения?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Каждая переменная должна входить в неотрицательный реляционный атом</div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">32</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Алгебра на Datalog (1)</h1><div class="body"><ul class="item-1 level-1"><li><span class="question">Как сделать <span class="mathO"><span class="math">$π_{A_1, ..., A_n}(R)$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Q(A1, ..., An) :- R(A1, ..., An, _, ..., _).
</pre></div></li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$σ_θ(R)$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Q(A1, ..., An) :- R(A1, ..., An), θ.
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 ∪ R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Q(A1, ..., An) :- R1(A1, ..., An).
Q(A1, ..., An) :- R2(A1, ..., An).
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 ∖ R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Q(A1, ..., An) :- R1(A1, ..., An), ¬R2(A1, ..., An).
</pre></div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">33</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Алгебра на Datalog (2)</h1><div class="body"><ul class="item-1 level-1"><li><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 × R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Q(A1, ..., An, B1, ..., Bm) :- 
    R1(A1, ..., An), R2(B1, ..., Bm).
</pre></div></li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Как сделать <span class="mathO"><span class="math">$R_1 ⋈ R_2$</span></span>?</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Q(A1, ..., An, B1, ..., Bm, C1, ..., Cl) :-
    R1(A1, ..., An, B1, ..., Bm), R2(B1, ..., Bm, C1, ..., Cl).
</pre></div></li></ul></div></li><li class="incremental"><div class="non-incremental">⇒ Datalog реляционно полон</div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">34</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Примеры</h1><div class="body"><ul class="item-1 level-1"><li>Таблица<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Person(Id, Name, FatherId, MotherId)
</pre></li></ul></li><li><span class="question">Получить для каждого человека имена обоих родителей: <var>(Name, Father, Mother)</var></span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Parents(N, FN, MN) :- Person(_, N, FId, MId),
    Person(FId, FN, _, _), Person(MId, MN, _, _).
</pre></div></li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Получить для каждого человека <br ignore="ignore" /><var>(Name, Parent)</var></span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Parents(N, FN) :- Person(_, N, FId, _),
    Person(FId, FN, _, _).
Parents(N, MN) :- Person(_, N, _, MId),
    Person(MId, MN, _, _).
</pre></div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">35</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Рекурсивные запросы</h1><div class="body"><ul class="item-1 level-1"><li>Таблицы<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">Parent(Id, ParentId)
</pre></li></ul></li><li>Найти всех предков<ul class="item-2 level-2"><li>Транзитивное замыкание</li><li class="incremental"><div class="non-incremental"><pre class="prettyprint lang-sql">Ancestor(Id, PId) :- Parent(Id, PId).
Ancestor(Id, GId) :- Parent(Id, PId), Ancestor(PId, GId).
</pre></div></li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Какой смысл?</span></div></li><li class="incremental"><div class="non-incremental">Минимальная неподвижная точка<ul class="item-2 level-2"><li>Минимальное по включению множество, такое, что левая и правая части совпадают</li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">36</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Алгоритм поиска</h1><div class="body"><ul class="item-1 level-1"><li>Алгоритм поиска минимальной неподвижной точки<ul class="item-2 level-2"><li>Инициализируем нерекурсивными данными</li><li>Пока есть следствия, пополняем ими</li></ul></li><li>Стратифицированное отрицание<ul class="item-2 level-2"><li>Не должно быть циклов, содержащих отрицания</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">37</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Реляционное исчисление и SQL</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Реляционное исчисление</a></li><li><a href="#(6)" class="toc">Исчисление кортежей</a></li><li><a href="#(14)" class="toc">Связь алгебры и исчисления</a></li><li><a href="#(21)" class="toc">Исчисление доменов</a></li><li><a href="#(27)" class="toc">Язык Datalog</a></li><li><a href="#(38)" class="toc current">Реляционное исчисление и SQL</a></li><li><a href="#(49)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">38</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Заголовок запроса</h1><div class="body"><ul class="item-1 level-1"><li>Определяет, какие атрибуты будут получены</li><li>Реляционная алгебра<ul class="item-2 level-2"><li>Самая внешняя проекция</li></ul></li><li>Реляционное исчисление<ul class="item-2 level-2"><li>Заголовок запроса</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">39</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Раздел from</h1><div class="body"><ul class="item-1 level-1"><li>Определяет набор отношений, с которыми производится работа</li><li>Реляционная алгебра<ul class="item-2 level-2"><li>Соединения</li></ul></li><li>Реляционное исчисление<ul class="item-2 level-2"><li>Переменные отношений</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">40</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Раздел where</h1><div class="body"><ul class="item-1 level-1"><li>Определяет набор кортежей, с которыми производится работа</li><li>Реляционная алгебра<ul class="item-2 level-2"><li>Самая внешняя фильтрация</li></ul></li><li>Реляционное исчисление<ul class="item-2 level-2"><li>Условия на кортежи</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">41</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Куда делись кванторы?</h1><div class="body"><ul class="item-1 level-1"><li>Большинство кванторов применяется для соединений</li><li>Подзапросы<ul class="item-2 level-2"><li>Существования (<var>exists</var>)</li><li>Вхождения (<var>in</var>)</li><li>Условные (<var>any</var>, <var>all</var>)</li><li>Скалярные</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">42</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Подзапросы существования</h1><div class="body"><ul class="item-1 level-1"><li>Аналогичные квантору существования</li><li>Квантор всеобщности не поддерживается<ul class="item-2 level-2"><li>Но <span class="mathO"><span class="math">$∀ v (p(v)) ≡ ¬∃v (¬p(v))$</span></span></li></ul></li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">[not] exists (select ...)
</pre></li></ul></li><li>Пример<ul class="item-2 level-2"><li>Группы, в которых нет студентов <pre class="prettyprint lang-sql">select G.Name from G where
not exists (select * from S where S.GId = G.GId)
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">43</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Подзапросы вхождения</h1><div class="body"><ul class="item-1 level-1"><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">(выражения) [not] in (select ...)
</pre></li></ul></li><li>Пример<ul class="item-2 level-2"><li>Оценки по предметам четвертого курса <pre class="prettyprint lang-sql">select * from P where P.CId in
    (select CId from C where Year = 4)
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">44</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Условные подзапросы</h1><div class="body"><ul class="item-1 level-1"><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">выражение условие { any | all } (select ...)
</pre></li></ul></li><li>Пример<ul class="item-2 level-2"><li>Лучшие студенты по предметам <pre class="prettyprint lang-sql">select SId, CId from P as PE where PE.Points &gt;=
    all (select Points from P where P.CId = PE.CId)
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">45</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Скалярные подзапросы</h1><div class="body"><ul class="item-1 level-1"><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">(select ...)
</pre></li></ul></li><li>Пример<ul class="item-2 level-2"><li>Студенты и название группы <pre class="prettyprint lang-sql">select
    SId,
    (select Name from G where G.GId = S.GId)
from S
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">46</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Коррелированные подзапросы</h1><div class="body"><ul class="item-1 level-1"><li>Коррелированный подзапрос<ul class="item-2 level-2"><li>Есть свободные переменные</li></ul></li><li>Некоррелированный подзапрос<ul class="item-2 level-2"><li>Нет свободных переменных</li></ul></li><li>Примеры<ul class="item-2 level-2"><li>Лучшие студенты по предметам <pre class="prettyprint lang-sql">select SId, CId from P as PE where PE.Points &gt;=
    all (select Points from P where P.CId = PE.CId)
</pre></li><li>Оценки по предметам четвертого курса <pre class="prettyprint lang-sql">select * from P where P.CId in
    (select CId from C where Year = 4)
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">47</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Рекурсия</h1><div class="body"><ul class="item-1 level-1"><li>Добавлена в SQL3</li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">with recursive Отношение(колонки) as ...
</pre></li><li>Отрицание должно быть стратифицировано</li></ul></li><li>Пример<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">with recursive Ancestor(Id, AId) as
    select Id, PId from Parent
    union
    select P.Id, A.AId from Ancestor A
        inner join Parent P on A.Id = P.PId
select * from Ancestor;
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">48</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Литература</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Реляционное исчисление</a></li><li><a href="#(6)" class="toc">Исчисление кортежей</a></li><li><a href="#(14)" class="toc">Связь алгебры и исчисления</a></li><li><a href="#(21)" class="toc">Исчисление доменов</a></li><li><a href="#(27)" class="toc">Язык Datalog</a></li><li><a href="#(38)" class="toc">Реляционное исчисление и SQL</a></li><li><a href="#(49)" class="toc current">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">49</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Основная литература</h1><div class="body"><ul class="item-1 level-1"><li><em>Дейт К.</em> Введение в системы баз данных (глава 8)</li><li><em>Уидом Д., Ульман Д.</em> Основы реляционных баз данных (главы 4 и 5)</li><li><em>Gulutzan P.</em>, <em>Pelzer T.</em> SQL-99 complete, really<ul class="item-2 level-2"><li><a href="https://crate.io/docs/sql-99/en/latest/chapters/31.html" target="_blank">Chapter 31 – Searching with Subqueries</a></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">50</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Дополнительная литература</h1><div class="body"><ul class="item-1 level-1"><li><em>Codd E. F.</em> A relational model of data for large shared data banks</li><li><em>Codd E. F.</em> Relational completeness of data base sublanguages</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / Реляционное исчисление</span><span class="number">51</span></div></div></div></div></div></body></html>