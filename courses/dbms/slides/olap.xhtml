<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="ru" xml:lang="ru" xmlns="http://www.w3.org/1999/xhtml"><head><title>Базы данных / OLAP</title><meta name="author" content="" /><link rel="stylesheet" type="text/css" media="screen, projection, print" href="scripts/slidy.css" /><link rel="stylesheet" type="text/css" href="scripts/prettify.css" /><link rel="stylesheet" type="text/css" href="scripts/kgeorgiy-slides.css" /><script type="text/javascript" src="scripts/slidy.js" charset="utf-8" /><script type="text/javascript" src="scripts/kgeorgiy-slides.js" charset="utf-8" /><script type="text/javascript" src="scripts/prettify.js" /><script type="text/javascript" src="scripts/lang-sql.js" /><script type="text/javascript" src="scripts/lang-javaModule.js" /><script type="text/javascript" src="scripts/lang-scala.js" /><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML" /><script type="text/javascript">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']], displayMath: [['$$','$$']], ignoreClass: "", processClass: "math|lang-math"}});</script><script>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-37693764-1"]);_gaq.push(["_setDomainName","kgeorgiy.info"]);_gaq.push(["_trackPageview"]);(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-8EQ66D87ZZ" /><script>
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());

                  gtag('config', 'G-8EQ66D87ZZ');
                </script></head><body onload="prettyPrint()"><div id="all">
<div class="slide cover"><div class="content"><div class="course">Базы данных</div><hr /><div class="lecture"><div>OLAP</div></div><div class="link"><a href="https://kgeorgiy.info/courses/dbms/">https://kgeorgiy.info/courses/dbms/</a></div><div class="copyright"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.ru"><span class="copyright">Copyright © Георгий Корнеев</span><img src="scripts/by-nc-sa.png" alt="Attribution-NonCommercial-ShareAlike" /></a></div></div></div>
<div class="slide section"><div class="content"><h1>Группировки</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Группировки</a></li><li><a href="#(5)" class="toc">Оконные функции</a></li><li><a href="#(16)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">2</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Множественные гуппировки</h1><div class="body"><ul class="item-1 level-1"><li>Подсчет статистики по нескольким группам<ul class="item-2 level-2"><li>По каждой в отдельности</li></ul></li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">group by grouping set (группы)
</pre></li><li>Группа – <var>(<span class="warn">колонки</span>)</var></li></ul></li><li>Пример<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">select
    student_id, group_id, student_name, avg(points)
group by grouping set (
    student_id,
    group_id,
    (group_id, student_name)
)
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">3</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Сгенерированные значения</h1><div class="body"><ul class="item-1 level-1"><li><span class="question">Отсутствющие значения</span><ul class="item-2 level-2"><li><var>null</var></li></ul></li><li><span class="question">Как отличить от настоящих</span> **</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">4</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Оконные функции</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Группировки</a></li><li><a href="#(5)" class="toc current">Оконные функции</a><ol class="level-2 toc-2"><li><a href="#(12)" class="">Оконные функции</a></li></ol></li><li><a href="#(16)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">5</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Устройство</h1><div class="body"><ul class="item-1 level-1"><li>Описываются в <var>select</var></li><li>Применяются после <var>where</var>/<var>group by</var>/<var>having</var></li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">function(столбцы | *) over (окно)
</pre></li></ul></li><li>Пример<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">select
    student_id,
    rank() over (
        partition by student_group
        order by avg_points
    )
from student_info
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">6</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Окна</h1><div class="body"><ul class="item-1 level-1"><li>Разбиение на корзины<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">partition by столбцы
</pre></li><li>По-умолчанию: одна корзина</li></ul></li><li>Порядок в корзине (группы)<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">order by порядки
</pre></li><li>По-умолчанию: все равны</li></ul></li><li>Выборка в корзине<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">фрейм
</pre></li><li>По-умолчанию: все</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">7</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Определение порядка</h1><div class="body"><ul class="item-1 level-1"><li>Выражение<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">выражение
</pre></li></ul></li><li>Порядок<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">[asc | desc]
</pre></li></ul></li><li>Обработка <var>null</var><ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">[nulls first|nulls last]
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">8</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Фреймы</h1><div class="body"><ul class="item-1 level-1"><li>Режим<ul class="item-2 level-2"><li><var>rows</var> – отдельные строки</li><li><var>groups</var> – группы равных строк</li><li><var>range</var> – диапазон строк<ul class="item-3 level-3"><li>Единственный столбец в <var>order by</var></li></ul></li></ul></li><li>Границы</li><li>Исключения<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">exclude исключение
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">9</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Границы</h1><div class="body"><ul class="item-1 level-1"><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-sql">граница
</pre></li><li><pre class="prettyprint lang-sql">between граница and граница
</pre></li></ul></li><li>Значения <table class="small"><tr><td><var>unbounded preceding</var></td><td> все от начала</td></tr><tr><td><var><span class="warn">число</span> preceding</var></td><td><span class="warn">число</span> до текущей</td></tr><tr><td><var>current row</var></td><td> только текущая</td></tr><tr><td><var><span class="warn">число</span> following</var></td><td><span class="warn">число</span> после текущей</td></tr><tr><td><var>unbounded following</var></td><td> все до конца</td></tr></table></li><li>Диапазон<ul class="item-2 level-2"><li>Границы – значения, считамые от значения текущей строки</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">10</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Исключения</h1><div class="body"><ul class="item-1 level-1"><li>Строки, удаляемые из окна <table><tr><td><var>current row</var></td><td> текущая</td></tr><tr><td><var>group</var></td><td> текущая группа целиком</td></tr><tr><td><var>ties</var></td><td> текущая группа без строки</td></tr><tr><td><var>no others</var></td><td> без удаления</td></tr></table></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">11</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Оконные функции</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Группировки</a></li><li><a href="#(5)" class="toc current">Оконные функции</a><ol class="level-2 toc-2"><li><a href="#(12)" class=" current">Оконные функции</a></li></ol></li><li><a href="#(16)" class="toc">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">12</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Порядковые функции</h1><div class="body"><ul class="item-1 level-1"><li><var>row_number()</var><ul class="item-2 level-2"><li>Номер строки</li></ul></li><li><var>rank()</var><ul class="item-2 level-2"><li>Номер первой строки в группе</li></ul></li><li><var>dense_rank()</var><ul class="item-2 level-2"><li>Номер группы</li></ul></li><li><var>ntile(<span class="mathO"><span class="math">$n$</span></span>)</var><ul class="item-2 level-2"><li>Номер корзины при равном разбиении на <span class="mathO"><span class="math">$n$</span></span> корзин</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">13</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Адресация по фрейму</h1><div class="body"><ul class="item-1 level-1"><li><var>first_value(значение)</var><ul class="item-2 level-2"><li><var>значение</var> для первой строки фрейма</li></ul></li><li><var>last_value(значение)</var><ul class="item-2 level-2"><li><var>значение</var> для последней строки фрейма</li></ul></li><li><var>nth_value(значение, номер)</var><ul class="item-2 level-2"><li><var>значение</var> для указанной строки</li><li><var>null</var>, если строка отсутствует</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">14</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Относительная адресация</h1><div class="body"><ul class="item-1 level-1"><li><var>lag(значение, смещение, умолчание)</var><ul class="item-2 level-2"><li>на <var>смещение</var> строк раньше</li></ul></li><li><var>lead(значение, смещение, умолчание)</var><ul class="item-2 level-2"><li>на <var>смещение</var> строк позже</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">15</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Литература</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Группировки</a></li><li><a href="#(5)" class="toc">Оконные функции</a></li><li><a href="#(16)" class="toc current">Литература</a></li></ol></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">16</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Основная литература</h1><div class="body"><ul class="item-1 level-1"><li><em>Дейт К.</em> Введение в системы баз данных (глава 26)</li><li><em>Фаулер М.</em> Архитектура корпоративных программных приложений (главы 3, 13)</li></ul></div><div class="footer"><div class="test"><span class="author">Георгий Корнеев</span><span class="title">Базы данных / OLAP</span><span class="number">17</span></div></div></div></div></div></body></html>