<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="ru" xml:lang="ru" xmlns="http://www.w3.org/1999/xhtml"><head><title>Технологии Java / Модули</title><meta name="author" content="" /><link rel="stylesheet" type="text/css" media="screen, projection, print" href="scripts/slidy.css" /><link rel="stylesheet" type="text/css" href="scripts/prettify.css" /><link rel="stylesheet" type="text/css" href="scripts/kgeorgiy-slides.css" /><script type="text/javascript" src="scripts/slidy.js" charset="utf-8" /><script type="text/javascript" src="scripts/kgeorgiy-slides.js" charset="utf-8" /><script type="text/javascript" src="scripts/prettify.js" /><script type="text/javascript" src="scripts/lang-sql.js" /><script type="text/javascript" src="scripts/lang-javaModule.js" /><script type="text/javascript" src="scripts/lang-scala.js" /><script>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-37693764-1"]);_gaq.push(["_setDomainName","kgeorgiy.info"]);_gaq.push(["_trackPageview"]);(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-8EQ66D87ZZ" /><script>
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());

                  gtag('config', 'G-8EQ66D87ZZ');
                </script></head><body onload="prettyPrint()"><div id="all">
<div class="slide cover"><div class="content"><div class="course">Технологии Java</div><hr /><div class="lecture"><div>Модули</div></div><div class="link"><a href="https://kgeorgiy.info/courses/java-advanced/">https://kgeorgiy.info/courses/java-advanced/</a></div><div class="copyright"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.ru"><span class="copyright">Copyright © Georgiy Korneev</span><img src="scripts/by-nc-sa.png" alt="Attribution-NonCommercial-ShareAlike" /></a></div></div></div>
<div class="slide section"><div class="content"><h1>Модули</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Модули</a></li><li><a href="#(7)" class="toc">Управление зависимостями</a></li><li><a href="#(11)" class="toc">Сервисы</a></li><li><a href="#(18)" class="toc">Модуляризованный JDK</a></li><li><a href="#(21)" class="toc">Обратная совместимость</a></li><li><a href="#(25)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">2</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Что такое модуль</h1><div class="body"><ul class="item-1 level-1"><li>Поддерево пакетов<ul class="item-2 level-2"><li>Управление зависимостями доступа</li><li>Сервисы</li><li>Контроль доступа</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">3</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Определение модуля</h1><div class="body"><ul class="item-1 level-1"><li>Файл <var>module-info.java</var><ul class="item-2 level-2"><li>В пакете по умолчанию</li></ul></li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">/** Javadoc */
[@Annotations]
[open] module имя.модуля {
    определения
}
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">4</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Module path</h1><div class="body"><ul class="item-1 level-1"><li><var>PATH</var>-like список<ul class="item-2 level-2"><li>Опция <var>--module-path</var> (<var>-p</var>)</li></ul></li><li>Подкаталоги<ul class="item-2 level-2"><li>Распакованные модули</li></ul></li><li>Jar-файлы<ul class="item-2 level-2"><li>Упакованные модули</li><li>Автоматические модули</li></ul></li><li>Обратная совместимость<ul class="item-2 level-2"><li><var>--add-module модуль</var> – добавить системный модуль в <var>CLASSPATH</var></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">5</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Компиляция и запуск</h1><div class="body"><ul class="item-1 level-1"><li>Компиляция<ul class="item-2 level-2"><li><var>javac</var></li><li><var>--module-path</var> – откомпилированные зависимости</li><li><var>--module-source-path</var> – зависимости в исходниках</li></ul></li><li>Запуск<ul class="item-2 level-2"><li><var>java</var></li><li><var>--module-path</var> – откомпилированные зависимости</li><li><var>--module модуль/класс</var> – что запускать</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">6</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Управление зависимостями</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Модули</a></li><li><a href="#(7)" class="toc current">Управление зависимостями</a></li><li><a href="#(11)" class="toc">Сервисы</a></li><li><a href="#(18)" class="toc">Модуляризованный JDK</a></li><li><a href="#(21)" class="toc">Обратная совместимость</a></li><li><a href="#(25)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">7</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Подключение зависимостей</h1><div class="body"><ul class="item-1 level-1"><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">requires [transitive] [static] имя.модуля;
</pre></li><li><var>transitive</var> – наследуемая зависимость</li><li><var>static</var> – времени компиляции</li></ul></li><li>Примеры<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">module info.kgeorgiy.java.base {
    requires transitive junit;
}
</pre></li><li><pre class="prettyprint lang-javaModule">module info.kgeorgiy.java.implementor {
    requires java.compiler;
    requires info.kgeorgiy.java.base;
}
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">8</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Экспортирование пакетов</h1><div class="body"><ul class="item-1 level-1"><li>Доступны во время компиляции и исполнения</li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">exports имя.пакета [to модуль1, модуль2, ...];
</pre></li><li>По-умолчанию: всем</li><li>«Модули-друзья»</li></ul></li><li>Пример<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">module info.kgeorgiy.java.base {
    exports info.kgeorgiy.java.base;
    exports info.kgeorgiy.java.base.test
        to info.kgeorgiy.java.test;
}
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">9</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Открытые пакеты</h1><div class="body"><ul class="item-1 level-1"><li>Полностью доступны для reflection</li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">opens имя.пакета [to модуль1, модуль2, ...];
</pre></li><li>По-умолчанию: всем</li><li>«Модули-друзья»</li></ul></li><li>Пример<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">module info.kgeorgiy.java.base {
    opens info.kgeorgiy.java.base.opened;
    opens info.kgeorgiy.java.base.test
        to info.kgeorgiy.java.test;
}
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">10</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Сервисы</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Модули</a></li><li><a href="#(7)" class="toc">Управление зависимостями</a></li><li><a href="#(11)" class="toc current">Сервисы</a></li><li><a href="#(18)" class="toc">Модуляризованный JDK</a></li><li><a href="#(21)" class="toc">Обратная совместимость</a></li><li><a href="#(25)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">11</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Сервис</h1><div class="body"><ul class="item-1 level-1"><li>Класс или интерфейс</li><li>Разные реализации<ul class="item-2 level-2"><li>Независимые</li><li>Выбирается во время исполнения</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">12</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Пример сервиса</h1><div class="body"><ul class="item-1 level-1"><li>Интерфейс<ul class="item-2 level-2"><li><pre class="prettyprint lang-java">public interface HelloService {
    void sayHello(final String to);
}
</pre></li></ul></li><li>Реализации<ul class="item-2 level-2"><li><pre class="prettyprint lang-java">public class HelloServiceEn implements HelloService {
    public void sayHello(final String to) {
        System.out.format("        Hello, %s%n", to);
    }
}
</pre></li><li><pre class="prettyprint lang-java">public class HelloServiceFr {
    public static HelloService provider() {
        return to -&gt; System.out.format("        Bonjour, %s%n", to);
    }
}
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">13</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Объявление реализаций сервисов</h1><div class="body"><ul class="item-1 level-1"><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">provides имя.класса.сервиса
    with реализация.1[, реализация.2]*;
</pre></li></ul></li><li>Пример<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">module i.k.j.helloModule {
    exports  i.k.j.helloModule.service;
    provides i.k.j.helloModule.service.HelloService with
            i.k.j.helloModule.service.HelloServiceEn,
            i.k.j.helloModule.service.HelloServiceFr;
}
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">14</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Объявление используемых сервисов</h1><div class="body"><ul class="item-1 level-1"><li>Все используемые сервисы должны быть объявлены</li><li>Синтаксис<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">uses имя.класса.сервиса;
</pre></li></ul></li><li>Пример<ul class="item-2 level-2"><li><pre class="prettyprint lang-javaModule">module i.k.j.testModule {
    requires i.k.j.helloModule;
    uses i.k.j.helloModule.service.HelloService;
}
</pre></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">15</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Загрузчик сервисов</h1><div class="body"><ul class="item-1 level-1"><li>Класс <var><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/ServiceLoader.html" target="_blank">ServiceLoader&lt;S&gt;</a></var> implements <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Iterable.html" target="_blank">Iterable&lt;S&gt;</a></var></var></li><li>Получение<ul class="item-2 level-2"><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/ServiceLoader.html#load(java.lang.Class,java.lang.ClassLoader)" target="_blank">ServiceLoader.load(S.class, classLoader?)</a></var> – указанный (контекстный) загрузчик</li><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/ServiceLoader.html#loadInstalled(java.lang.Class)" target="_blank">ServiceLoader.loadInstalled(S.class)</a></var> – системный загрузчик</li></ul></li><li>Методы<ul class="item-2 level-2"><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Optional.html" target="_blank">Optional&lt;S&gt;</a></var> <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/ServiceLoader.html#findFirst()" target="_blank">findFirst()</a></var> – любой</li><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Iterator.html" target="_blank">Iterator&lt;S&gt;</a></var> <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/ServiceLoader.html#iterator()" target="_blank">iterator()</a></var> – все</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">16</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Пример загрузки сервисов</h1><div class="body"><ul class="item-1 level-1"><li><pre class="prettyprint lang-java">ServiceLoader&lt;HelloService&gt; loader
    = ServiceLoader.load(HelloService.class);
for (HelloService service : loader) {
    service.sayHello("Main");
}
</pre></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">17</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Модуляризованный JDK</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Модули</a></li><li><a href="#(7)" class="toc">Управление зависимостями</a></li><li><a href="#(11)" class="toc">Сервисы</a></li><li><a href="#(18)" class="toc current">Модуляризованный JDK</a></li><li><a href="#(21)" class="toc">Обратная совместимость</a></li><li><a href="#(25)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">18</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Модуляризованный JDK</h1><div class="body"><ul class="item-1 level-1"><li>JDK 11 разбит на 73 модуля<ul class="item-2 level-2"><li>Часть планируют удалить</li><li><var>java.*</var> – основные</li><li><var>jdk.*</var> – реализация</li></ul></li><li>JDK 21 разбиты на 71 модуль (−6, +4)</li><li>Список модулей<ul class="item-2 level-2"><li><var>java --module-path путь --list-modules</var></li></ul></li><li>Информация о модуле<ul class="item-2 level-2"><li><var>java --module-path путь --describe-module модуль</var></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">19</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Специализация JDK</h1><div class="body"><ul class="item-1 level-1"><li>Содержит только необходимые модули<ul class="item-2 level-2"><li>Не требует указания <var>module-path</var></li></ul></li><li>Сборщик <var>jlink</var><ul class="item-2 level-2"><li><var>jlink --module-path путь --add-modules module,module...</var></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">20</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Обратная совместимость</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Модули</a></li><li><a href="#(7)" class="toc">Управление зависимостями</a></li><li><a href="#(11)" class="toc">Сервисы</a></li><li><a href="#(18)" class="toc">Модуляризованный JDK</a></li><li><a href="#(21)" class="toc current">Обратная совместимость</a></li><li><a href="#(25)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">21</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Взаимодействие с classpath</h1><div class="body"><ul class="item-1 level-1"><li>Безымянный модуль<ul class="item-2 level-2"><li>Весь <var>classpath</var></li><li>Доступ ко всем пользовательским модулям</li></ul></li><li>Доступ к модулям JDK<ul class="item-2 level-2"><li><var>--add-module module.name</var></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">22</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Автоматические модули</h1><div class="body"><ul class="item-1 level-1"><li>Jar-файлы<ul class="item-2 level-2"><li>На <var>modulepath</var></li><li>Без <var>module-info.class</var></li></ul></li><li>Автоматическое имя<ul class="item-2 level-2"><li>Генерируется по имени файла</li><li><var>hello-world-1.23.jar</var> ⇔ <var>module hello.world</var></li></ul></li><li>Через <var>MANIFEST.MF</var><ul class="item-2 level-2"><li>Атрибут <var>Automatic-Module-Name</var></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">23</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Управление зависимостями</h1><div class="body"><ul class="item-1 level-1"><li>Экспортирование<ul class="item-2 level-2"><li><var>--add-exports &lt;module&gt;/&lt;package&gt;=&lt;target-module&gt;</var></li></ul></li><li>Открытие<ul class="item-2 level-2"><li><var>--add-opens &lt;module&gt;/&lt;package&gt;=&lt;target-module&gt;</var></li></ul></li><li>Зависимости<ul class="item-2 level-2"><li><var>--add-reads &lt;module&gt;=&lt;target-module&gt;</var></li></ul></li><li>Изменение<ul class="item-2 level-2"><li><var>--patch-module &lt;module&gt;=&lt;file&gt;</var></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">24</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Заключение</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Модули</a></li><li><a href="#(7)" class="toc">Управление зависимостями</a></li><li><a href="#(11)" class="toc">Сервисы</a></li><li><a href="#(18)" class="toc">Модуляризованный JDK</a></li><li><a href="#(21)" class="toc">Обратная совместимость</a></li><li><a href="#(25)" class="toc current">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">25</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Ссылки</h1><div class="body"><ul class="item-1 level-1"><li>JLS: Module Declaration // <a href="https://docs.oracle.com/javase/specs/jls/se21/html/jls-7.html#jls-7.7" target="_blank">https://docs.oracle.com/javase/specs/jls/se21/<br />html/jls-7.html#jls-7.7</a></li><li>Javadoc: Service Loader // <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/ServiceLoader.html" target="_blank">https://docs.oracle.com/en/java/javase/21/<br />docs/api/java.base/java/util/ServiceLoader.html</a></li><li>Module System Quick-Start Guide // <a href="http://openjdk.java.net/projects/jigsaw/quick-start" target="_blank">http://openjdk.java.net/projects/jigsaw/quick-start</a></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">26</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Вопросы</h1><div class="body"><div class="questions">???</div></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Модули</span><span class="number">27</span></div></div></div></div></div></body></html>