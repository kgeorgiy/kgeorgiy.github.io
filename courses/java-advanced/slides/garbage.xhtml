<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="ru" xml:lang="ru" xmlns="http://www.w3.org/1999/xhtml"><head><title>Технологии Java / Сборка мусора</title><meta name="author" content="" /><link rel="stylesheet" type="text/css" media="screen, projection, print" href="scripts/slidy.css" /><link rel="stylesheet" type="text/css" href="scripts/prettify.css" /><link rel="stylesheet" type="text/css" href="scripts/kgeorgiy-slides.css" /><script type="text/javascript" src="scripts/slidy.js" charset="utf-8" /><script type="text/javascript" src="scripts/kgeorgiy-slides.js" charset="utf-8" /><script type="text/javascript" src="scripts/prettify.js" /><script type="text/javascript" src="scripts/lang-sql.js" /><script type="text/javascript" src="scripts/lang-javaModule.js" /><script type="text/javascript" src="scripts/lang-scala.js" /><script>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-37693764-1"]);_gaq.push(["_setDomainName","kgeorgiy.info"]);_gaq.push(["_trackPageview"]);(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-8EQ66D87ZZ" /><script>
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());

                  gtag('config', 'G-8EQ66D87ZZ');
                </script></head><body onload="prettyPrint()"><div id="all">
<div class="slide cover"><div class="content"><div class="course">Технологии Java</div><hr /><div class="lecture"><div>Сборка мусора</div></div><div class="link"><a href="https://kgeorgiy.info/courses/java-advanced/">https://kgeorgiy.info/courses/java-advanced/</a></div><div class="copyright"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.ru"><span class="copyright">Copyright © Georgiy Korneev</span><img src="scripts/by-nc-sa.png" alt="Attribution-NonCommercial-ShareAlike" /></a></div></div></div>
<div class="slide section"><div class="content"><h1>Сборка мусора</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Сборка мусора</a><ol class="level-2 toc-2"><li><a href="#(3)" class="">Мусор</a></li><li><a href="#(9)" class="">Поколения</a></li><li><a href="#(13)" class="">Простые сборщики мусора</a></li><li><a href="#(18)" class="">Shenandoah</a></li><li><a href="#(27)" class="">ZGC</a></li></ol></li><li><a href="#(44)" class="toc">Специальные ссылки</a></li><li><a href="#(52)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">2</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Мусор</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Сборка мусора</a><ol class="level-2 toc-2"><li><a href="#(3)" class=" current">Мусор</a></li><li><a href="#(9)" class="">Поколения</a></li><li><a href="#(13)" class="">Простые сборщики мусора</a></li><li><a href="#(18)" class="">Shenandoah</a></li><li><a href="#(27)" class="">ZGC</a></li></ol></li><li><a href="#(44)" class="toc">Специальные ссылки</a></li><li><a href="#(52)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">3</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Сборка мусора</h1><div class="body"><ul class="item-1 level-1"><li>Освобождение памяти</li><li>Дефрагментация памяти<ul class="item-2 level-2"><li>Объекты могут перемещаться</li></ul></li><li><span class="warn">Освобождение ресурсов</span></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">4</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Мусор</h1><div class="body"><ul class="item-1 level-1"><li>Корни<ul class="item-2 level-2"><li>Cсылка из стека</li><li>Глобальные переменные</li><li>Thread local переменные</li></ul></li><li>Достижимые объекты<ul class="item-2 level-2"><li>Есть корневая ссылка</li><li>Есть ссылка из достижимого объекта</li></ul></li><li>Недостижимые объекты<ul class="item-2 level-2"><li>Мусор</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">5</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Освобождение памяти</h1><div class="body"><ul class="item-1 level-1"><li>Подсчет ссылок<ul class="item-2 level-2"><li>Консервативный<ul class="item-3 level-3"><li>Проблемы с «циклическими» ссылками</li></ul></li><li>Простой, не ресурсоемкий</li></ul></li><li>Граф достижимых объектов<ul class="item-2 level-2"><li>Требуется построение графа<ul class="item-3 level-3"><li>приостановка исполнения</li><li>граф может быть большим</li></ul></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">6</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Построение графа</h1><div class="body"><ul class="item-1 level-1"><li>Выделение корней </li></ul><div class="img-width"><img class="width" style="width: 80%" src="pics/gc-roots.svg" /></div><ul class="item-1 level-1"><li>Разметка </li></ul><div class="img-width"><img class="width" style="width: 80%" src="pics/gc-mark.svg" /></div></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">7</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Дефрагментация памяти</h1><div class="body"><ul class="item-1 level-1"><li>Сжимающий сборщик<ul class="item-2 level-2"><li>Перемещает «живые» данные в начало памяти</li><li>Object handles<ul class="item-3 level-3"><li>Дополнительный уровень ссылок</li></ul></li></ul></li><li>Копирующий сборщик<ul class="item-2 level-2"><li>Перемещает «живые» данные в другой блок памяти</li><li>Исправляет ссылки на «ходу» </li></ul></li></ul><div class="img-width"><img class="width" style="width: 80%" src="pics/gc-compact.svg" /></div></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">8</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Поколения</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Сборка мусора</a><ol class="level-2 toc-2"><li><a href="#(3)" class="">Мусор</a></li><li><a href="#(9)" class=" current">Поколения</a></li><li><a href="#(13)" class="">Простые сборщики мусора</a></li><li><a href="#(18)" class="">Shenandoah</a></li><li><a href="#(27)" class="">ZGC</a></li></ol></li><li><a href="#(44)" class="toc">Специальные ссылки</a></li><li><a href="#(52)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">9</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Гипотеза о поколениях </h1><div class="body"><div class="img-width"><img class="width" style="width: 100%" src="pics/gc-lifetime.png" /></div></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">10</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Поколения</h1><div class="body"><ul class="item-1 level-1"><li>Эдем</li><li>Выжившие поколения (×n)</li><li>Старое поколение</li><li>Постоянное поколение </li></ul><div class="img-width"><img class="width" style="width: 100%" src="pics/gc-generations.svg" /></div></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">11</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Память с поколениями</h1><div class="body"><ul class="item-1 level-1"><li>Выделение памяти<ul class="item-2 level-2"><li>В Эдеме</li><li>Сдвиг указателя</li></ul></li><li>Быстрая сборка мусора<ul class="item-2 level-2"><li>Эдем → В<sub>1</sub></li><li>В<sub>i</sub> → В<sub>i+1</sub></li><li>В<sub>n</sub> → Старые</li></ul></li><li>Полная сборка мусора<ul class="item-2 level-2"><li>Долго при большой куче</li></ul></li><li class="incremental"><div class="non-incremental"><span class="question">Ссылки из старых в новые</span><ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Карты памяти</div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">12</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Простые сборщики мусора</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Сборка мусора</a><ol class="level-2 toc-2"><li><a href="#(3)" class="">Мусор</a></li><li><a href="#(9)" class="">Поколения</a></li><li><a href="#(13)" class=" current">Простые сборщики мусора</a></li><li><a href="#(18)" class="">Shenandoah</a></li><li><a href="#(27)" class="">ZGC</a></li></ol></li><li><a href="#(44)" class="toc">Специальные ссылки</a></li><li><a href="#(52)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">13</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Последовательный</h1><div class="body"><ul class="item-1 level-1"><li><var>SerialGC</var></li></ul><img class="height" style="height: 80%" src="pics/gc-serial.svg" /></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">14</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Параллельный</h1><div class="body"><ul class="item-1 level-1"><li><var>ParallelGC</var></li></ul><img class="height" style="height: 80%" src="pics/gc-parallel.svg" /></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">15</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Одновременный</h1><div class="body"><ul class="item-1 level-1"><li><var>ConcMarkSweepGC</var></li></ul><img class="height" style="height: 90%" src="pics/gc-cms.svg" /></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">16</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Garbage-First</h1><div class="body"><ul class="item-1 level-1"><li><var>G1GC</var></li></ul><img class="height" style="height: 80%" src="pics/gc-g1.svg" /></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">17</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>Shenandoah</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Сборка мусора</a><ol class="level-2 toc-2"><li><a href="#(3)" class="">Мусор</a></li><li><a href="#(9)" class="">Поколения</a></li><li><a href="#(13)" class="">Простые сборщики мусора</a></li><li><a href="#(18)" class=" current">Shenandoah</a></li><li><a href="#(27)" class="">ZGC</a></li></ol></li><li><a href="#(44)" class="toc">Специальные ссылки</a></li><li><a href="#(52)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">18</span></div></div></div></div>
<div class="slide"><div class="content"><h1>STW: Начало разметки </h1><div class="body"><div class="img-width"><img class="width" style="width: 60%" src="pics/gc-sd-01-init-mark.svg" /></div><ul class="item-1 level-1"><li>Подготовка к разметке</li><li>Разметка корней</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">19</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Разметка </h1><div class="body"><div class="img-width"><img class="width" style="width: 60%" src="pics/gc-sd-02-mark.svg" /></div><ul class="item-1 level-1"><li>Параллельная разметка</li><li>Подсчёт реальной занятости регионов</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">20</span></div></div></div></div>
<div class="slide"><div class="content"><h1>STW: Окончание разметки </h1><div class="body"><div class="img-width"><img class="width" style="width: 60%" src="pics/gc-sd-03-final-mark.svg" /></div><ul class="item-1 level-1"><li>Переразметка корней<ul class="item-2 level-2"><li>Дообновление</li></ul></li><li>Подготовка к перемещению<ul class="item-2 level-2"><li>Какие регионы и куда</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">21</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Перемещение </h1><div class="body"><div class="img-width"><img class="width" style="width: 60%" src="pics/gc-sd-04-evacuate.svg" /></div><ul class="item-1 level-1"><li>Параллельное перемещение объектов</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">22</span></div></div></div></div>
<div class="slide"><div class="content"><h1>STW: Начало обновления </h1><div class="body"><div class="img-width"><img class="width" style="width: 60%" src="pics/gc-sd-05-init-update.svg" /></div><ul class="item-1 level-1"><li>Окончание перемещений</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">23</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Обновление </h1><div class="body"><div class="img-width"><img class="width" style="width: 60%" src="pics/gc-sd-06-updating.svg" /></div><ul class="item-1 level-1"><li>Параллельное обновление ссылок<ul class="item-2 level-2"><li>Линейный обход кучи</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">24</span></div></div></div></div>
<div class="slide"><div class="content"><h1>STW: Окончание обновления </h1><div class="body"><div class="img-width"><img class="width" style="width: 60%" src="pics/gc-sd-07-final-update.svg" /></div><ul class="item-1 level-1"><li>Обновление корней</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">25</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Фазы</h1><div class="body"><ul class="item-1 level-1"><li>STW: Начало разметки</li><li>Разметка</li><li>STW: Окончание разметки</li><li>Перемещение</li><li>STW: Начало обновления</li><li>Обновление</li><li>STW: Окончание обновления</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">26</span></div></div></div></div>
<div class="slide subsection"><div class="content"><h1>ZGC</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc current">Сборка мусора</a><ol class="level-2 toc-2"><li><a href="#(3)" class="">Мусор</a></li><li><a href="#(9)" class="">Поколения</a></li><li><a href="#(13)" class="">Простые сборщики мусора</a></li><li><a href="#(18)" class="">Shenandoah</a></li><li><a href="#(27)" class=" current">ZGC</a></li></ol></li><li><a href="#(44)" class="toc">Специальные ссылки</a></li><li><a href="#(52)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">27</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Исходное состояние </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-01-initial.svg" /></div></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">28</span></div></div></div></div>
<div class="slide"><div class="content"><h1>STW1: Инициализация разметки </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-02-stw1.svg" /></div><ul class="item-1 level-1"><li>Переключение цвета (M1 → M0)<ul class="item-2 level-2"><li>Обновление корней</li></ul></li><li>Новые TLAB</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">29</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Разметка/обновление </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-03-mark.svg" /></div><ul class="item-1 level-1"><li>Обход достижимых объектов<ul class="item-2 level-2"><li>Подсчёт объёма живых данных на странице</li><li>Обновление указателей</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">30</span></div></div></div></div>
<div class="slide"><div class="content"><h1>STW2: Окончание разметки </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-04-stw2.svg" /></div><ul class="item-1 level-1"><li>Все достижимые объекты размечены</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">31</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Обработка страниц </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-05-select-ec.svg" /></div><ul class="item-1 level-1"><li>Сбор непосещённых</li><li>Выбор перемещаемых<ul class="item-2 level-2"><li>Сортировка по заполняемости</li><li>Выбор доли наименее заполненных</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">32</span></div></div></div></div>
<div class="slide"><div class="content"><h1>STW3: Переключение </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-06-stw3.svg" /></div><ul class="item-1 level-1"><li>Переключение цвета (M0 → R)</li><li>Сброс старых перемещений</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">33</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Перемещение (1) </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-07-relocation-1.svg" /></div><ul class="item-1 level-1"><li>Ссылка на перемещаемый объект</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">34</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Перемещение (2) </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-08-relocation-2.svg" /></div><ul class="item-1 level-1"><li>Объект перемещён</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">35</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Перемещение (3) </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-09-relocation-3.svg" /></div><ul class="item-1 level-1"><li>Ссылка на перемещённый объект</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">36</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Перемещение (4) </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-10-relocation-4.svg" /></div><ul class="item-1 level-1"><li>Обновление ссылки</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">37</span></div></div></div></div>
<div class="slide"><div class="content"><h1>STW1: Инициализация разметки </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-11-stw1.svg" /></div><ul class="item-1 level-1"><li>Переключение цвета (R → M1)<ul class="item-2 level-2"><li>Обновление корней</li></ul></li><li>Новые TLAB</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">38</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Разметка/обновление </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-12-mark.svg" /></div><ul class="item-1 level-1"><li>Обход достижимых объектов<ul class="item-2 level-2"><li>Подсчёт объёма живых данных на странице</li><li>Обновление указателей</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">39</span></div></div></div></div>
<div class="slide"><div class="content"><h1>STW2: Окончание разметки </h1><div class="body"><div class="img-width"><img class="width" style="width: 95%" src="pics/gc-zgc-13-stw2.svg" /></div><ul class="item-1 level-1"><li>Все достижимые объекты размечены</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">40</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Фазы</h1><div class="body"><ul class="item-1 level-1"><li>STW1: Инициализация разметки</li><li>Разметка/обновление</li><li>STW2: Окончание разметки</li><li>Обработка страниц</li><li>STW3: Переключение на перемещение</li><li>Перемещение</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">41</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Как сделать быстро?</h1><div class="body"><ul class="item-1 level-1"><li>Помеченные указатели<ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Нужны биты для пометок</div></li><li class="incremental"><div class="non-incremental">Младшие не всегда можно использовать</div></li><li class="incremental"><div class="non-incremental">Используем старшие</div></li><li class="incremental"><div class="non-incremental">Другая область памяти</div></li><li class="incremental"><div class="non-incremental">Страницы памяти, отображаемые в несколько мест</div></li></ul></li><li class="incremental"><div class="non-incremental">Доступ<ul class="item-2 level-2"><li class="incremental"><div class="non-incremental">Указатель помечен → всё ok</div></li><li class="incremental"><div class="non-incremental">Если не требуется переместить, то пометим</div></li><li class="incremental"><div class="non-incremental">Если уже перемещён, обновим ссылку и пометим</div></li><li class="incremental"><div class="non-incremental">Если не перемещён, то переместим сами</div></li></ul></div></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">42</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Свойства ZGC</h1><div class="body"><ul class="item-1 level-1"><li>Не основан на поколениях</li><li>Регионы памяти<ul class="item-2 level-2"><li>Маленькие, средние, большие объекты</li></ul></li><li>В основном параллельный</li><li>Разметка+перемещение</li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">43</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Специальные ссылки</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Сборка мусора</a></li><li><a href="#(44)" class="toc current">Специальные ссылки</a></li><li><a href="#(52)" class="toc">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">44</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Специальные ссылки</h1><div class="body"><ul class="item-1 level-1"><li>Явные ссылки на объекты<ul class="item-2 level-2"><li>Могут быть собраны сборщиком мусора</li><li>Информация о сборе</li></ul></li><li>Пакет <var>java.lang.ref</var></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">45</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Абстрактная ссылка</h1><div class="body"><ul class="item-1 level-1"><li>Класс <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/Reference.html" target="_blank">Reference&lt;T&gt;</a></var><ul class="item-2 level-2"><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/Reference.html#get()" target="_blank">get()</a></var> — получить объект или <var>null</var></li><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/Reference.html#clear()" target="_blank">clear()</a></var> — присвоить <var>null</var></li><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/Reference.html#enqueue()" target="_blank">enqueue()</a></var> — поместить в очередь</li><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/Reference.html#isEnqueued()" target="_blank">isEnqueued()</a></var> — находится ли в очереди</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">46</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Мягкие ссылки</h1><div class="body"><ul class="item-1 level-1"><li>Класс <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/SoftReference.html" target="_blank">SoftReference&lt;T&gt;</a></var><ul class="item-2 level-2"><li>Собираются, когда кончается память</li><li>Рекомендуется собирать LRU</li></ul></li><li>Применение<ul class="item-2 level-2"><li>Кэши</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">47</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Слабые ссылки</h1><div class="body"><ul class="item-1 level-1"><li>Класс <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/WeakReference.html" target="_blank">WeakReference&lt;T&gt;</a></var><ul class="item-2 level-2"><li>Собираются, когда нет сильных и мягких ссылок</li></ul></li><li>Класс <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/WeakHashMap.html" target="_blank">WeakHashMap&lt;K, V&gt;</a></var><ul class="item-2 level-2"><li>Слабые ссылки на ключи</li></ul></li><li>Применение<ul class="item-2 level-2"><li>Identity-кэши с автоматическим удалением</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">48</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Фантомные ссылки</h1><div class="body"><ul class="item-1 level-1"><li>Класс <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/PhantomReference.html" target="_blank">PhantomReference&lt;T&gt;</a></var><ul class="item-2 level-2"><li>Объект невозможно получить</li><li>Помещаются в очередь после финализации</li></ul></li><li>Применение<ul class="item-2 level-2"><li>Действия по очистке</li><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/Cleaner.html" target="_blank">Cleaner</a></var></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">49</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Очереди ссылок</h1><div class="body"><ul class="item-1 level-1"><li>Класс <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/ReferenceQueue.html" target="_blank">ReferenceQueue&lt;T&gt;</a></var><ul class="item-2 level-2"><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/ReferenceQueue.html#poll()" target="_blank">poll()</a></var> — неблокирующее чтение с удалением</li><li><var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ref/ReferenceQueue.html#remove(long)" target="_blank">remove(timeout?)</a></var> — блокирующее чтение с удалением</li></ul></li><li>Использование<ul class="item-2 level-2"><li>Указание очереди при создании ссылки</li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">50</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Финализация</h1><div class="body"><ul class="item-1 level-1"><li>Метод <var><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" target="_blank">object.finalize()</a></var><ul class="item-2 level-2"><li><span class="warn">Deprecated for removal</span></li><li>Вызывается сборщиком мусора<ul class="item-3 level-3"><li>Время вызова не гарантируется</li><li>Часто остаётся до следующего GC</li></ul></li><li><span class="warn">Может «возродить» объект</span><ul class="item-3 level-3"><li>Вызывается только один раз</li></ul></li><li>Использование<ul class="item-3 level-3"><li>Проверка ресурсов</li><li><span class="warn">Освобождение ресурсов</span></li></ul></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">51</span></div></div></div></div>
<div class="slide section"><div class="content"><h1>Заключение</h1><h2>Содержание</h2><div class="body"><ol class="level-1 toc-1"><li><a href="#(2)" class="toc">Сборка мусора</a></li><li><a href="#(44)" class="toc">Специальные ссылки</a></li><li><a href="#(52)" class="toc current">Заключение</a></li></ol></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">52</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Ссылки (1)</h1><div class="body"><ul class="item-1 level-1"><li>Garbage Collection <br ignore="ignore" /><a href="http://www.artima.com/insidejvm/ed2/gcP.html" target="_blank">http://www.artima.com/insidejvm/ed2/gcP.html</a></li><li>Weak, Soft, and Phantom References in Java <br ignore="ignore" /><a href="https://dzone.com/articles/weak-soft-and-phantom-references-in-java-and-why-they-matter" target="_blank">https://dzone.com/articles/weak-soft-and-phantom-references-in-java-and-why-they-matter</a></li><li>HotSpot VM Garbage Collection Tuning Guide <br ignore="ignore" /><a href="https://docs.oracle.com/en/java/javase/20/gctuning/" target="_blank">https://docs.oracle.com/en/java/javase/20/gctuning/</a></li><li>Package java.lang.ref <br ignore="ignore" /><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/ref/package-summary.html" target="_blank">https://docs.oracle.com/en/java/javase/20/<br />docs/api/java.base/java/lang/ref/package-summary.html</a></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">53</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Ссылки (2)</h1><div class="body"><ul class="item-1 level-1"><li>Shenandoah GC <br ignore="ignore" /><a href="https://wiki.openjdk.org/display/shenandoah/Main" target="_blank">https://wiki.openjdk.org/display/shenandoah/Main</a></li><li>Deep Dive into ZGC <br ignore="ignore" /><a href="https://dl.acm.org/doi/10.1145/3538532" target="_blank">https://dl.acm.org/doi/10.1145/3538532</a></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">54</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Ссылки (3)</h1><div class="body"><ul class="item-1 level-1"><li>Алексей Шипилёв <br ignore="ignore" /><a href="https://shipilev.net/" target="_blank">https://shipilev.net/</a><ul class="item-2 level-2"><li>Java Objects Inside Out <br ignore="ignore" /><a href="https://shipilev.net/jvm/objects-inside-out/" target="_blank">https://shipilev.net/jvm/objects-inside-out/</a></li><li>Do It Yourself (OpenJDK) Garbage Collector <br ignore="ignore" /><a href="https://shipilev.net/jvm/diy-gc/" target="_blank">https://shipilev.net/jvm/diy-gc/</a></li><li>Java Memory Model Pragmatics <br ignore="ignore" /><a href="https://shipilev.net/blog/2014/jmm-pragmatics/" target="_blank">https://shipilev.net/blog/2014/jmm-pragmatics/</a></li></ul></li></ul></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">55</span></div></div></div></div>
<div class="slide"><div class="content"><h1>Вопросы</h1><div class="body"><div class="questions">???</div></div><div class="footer"><div class="test"><span class="author">Georgiy Korneev</span><span class="title">Технологии Java / Сборка мусора</span><span class="number">56</span></div></div></div></div></div></body></html>